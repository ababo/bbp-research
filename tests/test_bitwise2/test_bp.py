"""Tests for operations related to Boolean backpropagation."""

import bitwise2
from bitwise2 import bp


def test_row_activation():
    """Test row_activation()."""

    x = bitwise2.bit_tensor(
        [
            ["11010011100010110101101000111001_01100101110110011101100010011010"],
            ["00101110011010100011110010110100_10101001010100010111000100011110"],
            ["11100011001101011110100111010001_00011011101001101110001100110101"],
            ["01010010111100011011001000001111_11001100100010101100101010011000"],
        ]
    )
    w = bitwise2.bit_tensor(
        [
            "10101010101010101010101010101010_10101010101010101010101010101010",
            "00101100011101001010010111000110_10011010001001100010011101100101",
            "11001100110011001100110011001100_11001100110011001100110011001100",
            "00011100110010100001011000101110_11100100010110010001110011001010",
        ]
    )
    assert bp.row_activation(x, w) == bitwise2.bit_tensor(
        [["1011"], ["1111"], ["1110"], ["1111"]]
    )
